<!doctype html>
<html lang="en" ng-app="AnnotatedTutorial">
  <head>
    <meta charset="UTF-8">
    <title>Annotated Tutorial</title>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <link rel="stylesheet" href="css/main.css">
    <script src="scripts/modernizr.js"></script>

  </head>
  <body ng-controller="mainController">
    <div class="l-wrap">
      <div class="grid grid--full is-extended">
          <div class="grid__item three-quarters is-extended content">
            <div class="l-block grid grid--full">
                <div class="grid__item one-tenth is-right-aligned"></div>
                <!--
              --> <div class="grid__item six-eighths">
                    <div id="general"></div>
                    <h1 class="tutorial-title">{{tutorial.title}}</h1>
                    <h3 class="tutorial-author">by {{tutorial.author}}</h3>
                <!-- Buttons to toggle the list of authors-->
                <div ng-click="contributorFlag = showContributors(contributorFlag)">
                        <div class="contributors-plus" ng-show="!contributorFlag"></div>
                        <div class="contributors-minus" ng-show="contributorFlag"></div>
                </div>
                <div class="contributor-button"
                     ng-click="contributorFlag=showContributors(contributorFlag)">{{listOfContributors.length.toString()}} Other contributors
                 </div>
                 <div ng-show="contributorFlag">
                    <div ng-repeat="contributor in listOfContributors">
                         <div class="contributor-first" ng-if="contributor == listOfContributors[0]">{{contributor}},</div>
                         <div class="contributor" ng-if="contributor!=listOfContributors[0] && contributor!=listOfContributors[listOfContributors.length-1]">{{contributor}},</div>
                         <div class="contributor" ng-if="contributor!=listOfContributors[0] && contributor===listOfContributors[listOfContributors.length-1]">{{contributor}}</div>
                    </div>
                 </div>
            </div>
           </div>

          <div class="l-block grid grid--full"
               ng-repeat="step in listOfSteps"
               ng-mouseenter="hover = true"
               ng-mouseleave="hover = false"
               ng-if="step.step_number<listOfSteps.length-1"
               ng-class="{'selected-step':selectedStepsList.indexOf(step)!=-1 || noteStepList.indexOf(step.id)!=-1}">

              <div class="grid__item one-tenth">
                  <button class=""></button>
              </div>
              <!-- Buttons to toggle on/off notes -->
              <div class="grid__item six-eighths">
                  <div id="{{step.id}}">
                      <h2 ng-if="!(step.step_number==0) && (step.step_number<(tutorial.steps.length-2))">Step {{step.step_number}}</h2>
                  </div>
                  <div id="{{tutorial.steps[tutorial.steps.length-2].id}}" ng-if="(step.step_number==(tutorial.steps.length-2))"></div>
                  <div class="main-content" ng-bind-html="step.html"></div>
              </div><!--

           --><div>
                  <div ng-if="tutorial.notes" class="three-tenths">
                      <div class="grid__item three-tenths sort-container sort">
                          <div class="note-display">SORT</div>
                          <label>
                          <select class="dropdown" id="sort" onchange="sortSelected()">
                          <option value="new" selected>RECENT</option>
                          <option value="old">OLDEST</option>
                          <option value="high">RATE:HIGH</option>
                          <option value="low">RATE:LOW</option>
                          </select>
                          </label>
                      </div>
                          <button id="apply" ng-click="newSort();newFilter(chosenFilter)"></button>

                      <div class="grid__item three-tenths note-container">
                      <note ng-repeat="note in listOfNotes"
                            ng-if="!tutorial.baseline && canShowNote(note)"
                            note="note"
                            delete-it="deleteNote"
                            rate-it="newRating"
                            add-reply="addingReply"
                            can-show-note="canShowNote"
                            baseline="false"
                            show-list="showStepList"
                            user="contributor"
                            general="note.step_id[0] === listOfSteps[listOfSteps.length-1].id"
                            date="dateFormat(note)"
                            current-note="note === currentNote"
                            notelist="getNoteList(note)">
                      </note>
                      </div>
                      <div class="input-container grid__item three-tenths">
                          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
                          <div class ="window-title">Write your note below.</div>
                          <br>
                          <textarea class="input-text" ng-model="$parent.newNote" rows="6" placeholder="Please enter your note here."></textarea>
                          <button ng-click="submitNote()" class="plain-button">Submit</button>
                      </div>
                  </div>
          </div>
          <script>
              var chosenSort = null;
              function sortSelected(){
                  chosenSort = document.getElementById("sort").value.toString();
                  document.getElementById("apply").click();
              }
          </script>
          </div>
          </div>
      </div>
    </div>


    <script src="scripts/dependencies.js"></script>

    <script src="scripts/templates.js"></script>

    <script src="scripts/app.js"></script>
  </body>
</html>