<!doctype html>
<html lang="en" ng-app="AnnotatedTutorial">
  <head>
    <meta charset="UTF-8">
    <title>Annotated Tutorial</title>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <link rel="stylesheet" href="css/main.css">
    <!-- build:[src] scripts/ -->
    <script src="modernizr/modernizr.js"></script>
    <!-- /build -->

  </head>
  <body ng-controller="mainController">
    <div class="l-wrap">
      <div class="grid grid--full is-extended">
          <div class="grid__item three-quarters is-extended content">
            <div class="l-block grid grid--full">
                <div class="grid__item one-tenth is-right-aligned"></div>
                <!--
              --> <div class="grid__item six-eighths">
                    <div id="general"></div>
                    <h1 class="tutorial-title">{{tutorial.title}}</h1>
                    <h3 class="tutorial-author">by {{tutorial.author}}</h3>
                <!-- Buttons to toggle the list of authors-->
                <div ng-click="contributorFlag = showContributors(contributorFlag)">
                        <div class="contributors-show" ng-show="!contributorFlag"></div>
                        <div class="contributors-hide" ng-show="contributorFlag"></div>
                </div>
                <div class="contributor-button"
                     ng-click="contributorFlag=showContributors(contributorFlag)">{{listOfContributors.length.toString()}} contributors
                 </div>
                 <div ng-show="contributorFlag">
                    <div ng-repeat="contributor in listOfContributors">
                         <div class="contributor-first" ng-if="contributor == listOfContributors[0]">{{contributor}},</div>
                         <div class="contributor" ng-if="contributor!=listOfContributors[0] && contributor!=listOfContributors[listOfContributors.length-1]">{{contributor}},</div>
                         <div class="contributor" ng-if="contributor!=listOfContributors[0] && contributor===listOfContributors[listOfContributors.length-1]">{{contributor}}</div>
                    </div>
                 </div>
            </div>
           </div>

          <div class="l-block grid grid--full"
               ng-repeat="step in listOfSteps"
               ng-mouseenter="hover = true"
               ng-mouseleave="hover = false"
               ng-if="step.step_number<listOfSteps.length-1"
               ng-class="{'selected-step':selectedStepsList.indexOf(step)!=-1 || noteStepList.indexOf(step.id)!=-1}">

              <div class="grid__item one-tenth">
                  <button class=""></button>
              </div>
              <div class="grid__item six-eighths">
                  <div id="{{step.id}}">
                      <div class="step-title" ng-if="!(step.step_number==0) && (step.step_number<(tutorial.steps.length-2))">Step {{step.step_number}}</div>
                  </div>
                  <div id="{{tutorial.steps[tutorial.steps.length-2].id}}" ng-if="(step.step_number==(tutorial.steps.length-2))"></div>
                  <div class="main-content" ng-bind-html="step.html"></div>
              </div>
          </div><!--

           --><div>
                  <div ng-if="tutorial.notes" class="three-tenths">
                      <div class="grid__item three-tenths sort-container sort">
                          <div class="note-display">Sort Comments by</div>
                          <button class="sort-button" ng-click="sortSelected('new'); newSort()" ng-class="{'sort-button-selected':chosenSort =='new'}">RECENT</button>
                          <button class="sort-button" ng-click="sortSelected('old');newSort()" ng-class="{'sort-button-selected':chosenSort =='old'}">OLDEST</button>
                          <button class="sort-button" ng-click="sortSelected('high');newSort()" ng-class="{'sort-button-selected':chosenSort =='high'}">RATING HIGH</button>
                          <button class="sort-button" ng-click="sortSelected('low');newSort()" ng-class="{'sort-button-selected':chosenSort =='low'}">RATING LOW</button>
                      </div>

                      <div class="grid__item three-tenths note-container">
                      <note ng-repeat="note in listOfNotes"
                            ng-if="canShowNote(note) && note.reply_to==null"
                            note="note"
                            delete-it="deleteNote"
                            rate-it="newRating"
                            add-reply="addingReply"
                            can-show-note="canShowNote"
                            user="contributor"
                            date="dateFormat(note)"
                            current-reply="replyTo"
                            top-note="listOfNotes.indexOf(note)==0">
                      </note>
                      </div>
                      <div class="input-container grid__item three-tenths">
                          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
                          <div>
                              <div ng-if="replyTo!=null">Replying to {{replyToContributor}}: {{(tutorial.notes[findNoteIndex(replyTo)].content)}}</div>
                              <div ng-if="replyTo==null"><br></div>
                          </div>
                          <textarea class="input-text text" ng-model="$parent.newNote" rows="6" placeholder="Type in your comment here..."></textarea>
                          <button ng-click="submitNote()" class="submit-button">COMMENT</button>
                      </div>
                  </div>
          </div>
          </div>
          </div>
      </div>
    </div>


    <!-- build:remove -->
    <script>
      DEVELOPMENT = true;
    </script>
    <!-- /build -->

    <!-- build:js scripts/dependencies.js -->
    <script src="/angularjs/angular.js"></script>
    <script src="/angular-sanitize/angular-sanitize.js"></script>
    <script src="/moment/moment.js"></script>
    <script src="/angular-moment/angular-moment.js"></script>
    <!-- /build -->

    <!-- build:js scripts/templates.js -->
    <script src="/scripts/templates/templates.js"></script>
    <!-- /build -->

    <!-- build:js scripts/app.js -->
    <script src="/scripts/app.js"></script>
    <script src="/scripts/tutorialService.js"></script>
    <script src="/scripts/loggerService.js"></script>
    <script src="/scripts/mainController.js"></script>
    <script src="/scripts/recursionHelper.js"></script>
    <script src="/scripts/noteDirective.js"></script>
    <script src="/scripts/smooth-scrolling.js"></script>
    <!-- /build -->
  </body>
</html>